name: Post Release

on:
  workflow_dispatch:
    inputs:
      target_branch:
        description: 'Target branch (e.g., main, 8.0-stable)'
        required: true
        default: 'main'
        type: string
  repository_dispatch:
    types: [post-release]

jobs:
  post-release:
    uses: AlchemyCMS/.github/.github/workflows/post-release.yml@main
    with:
      version_file_path: lib/alchemy/version.rb
      target_branch: ${{ github.event.client_payload.target_branch || inputs.target_branch }}
    secrets:
      app_id: ${{ vars.ALCHEMY_BOT_APP_ID }}
      app_private_key: ${{ secrets.ALCHEMY_BOT_APP_PRIVATE_KEY }}
      slack_webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
      mastodon_access_token: ${{ secrets.MASTODON_ACCESS_TOKEN }}
      mastodon_instance: ${{ secrets.MASTODON_INSTANCE }}
      bluesky_identifier: ${{ secrets.BLUESKY_IDENTIFIER }}
      bluesky_password: ${{ secrets.BLUESKY_PASSWORD }}
