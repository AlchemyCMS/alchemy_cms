(function() {
  var payload,
      element = <%== Alchemy::ElementSerializer.new(@element, scope: current_ability).to_json %>;

<%- if @cut_element_id -%>
  // $('.element-editor[data-element-id="<%= @cut_element_id %>"]').remove();
<%- end -%>

<% if @element.fixed? %>
  // if ($('#fixed-elements').length == 0) {
  //   Alchemy.FixedElements.buildTabs('<%= Alchemy.t(:main_content) %>');
  // }
  // Alchemy.FixedElements.createTab('<%= @element.id %>', '<%= @element.display_name %>');
  // $element_area = $('#fixed-element-<%= @element.id %>');
<% elsif @element.parent_element %>
  payload = {
    parent_id: <%= @element.parent_element_id %>,
    element: element
  };
<%- else -%>
  payload = { element: element };
<%- end -%>

<%- if @insert_at_top -%>
  payload.insert_at_top = true;
<%- end -%>

  Alchemy.vuexStore.commit('addElement', payload);
  Alchemy.growl('<%= Alchemy.t(:successfully_added_element) %>');
  Alchemy.closeCurrentDialog();
  Alchemy.PreviewWindow.reload(<%= @element.id %>);
  $el = $('#element_<%= @element.id %>');
  $el.trigger('FocusElementEditor.Alchemy');

<%- if @clipboard.blank? -%>
  // $('#clipboard_button .icon.clipboard').removeClass('full');
<%- end -%>
})();
